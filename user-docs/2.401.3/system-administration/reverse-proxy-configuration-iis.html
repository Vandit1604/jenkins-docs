<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Reverse proxy - IIS :: Jenkins</title>
    <link rel="canonical" href="https://docs.jenkins.com/user-docs/2.401.3/system-administration/reverse-proxy-configuration-iis.html">
    <meta name="generator" content="Antora 3.1.5">
    <link rel="stylesheet" href="../../../_/css/site.css">
    <script>var uiRootPath = '../../../_'</script>
<link rel="icon" href="../../../_/jenkins.svg" type="image/x-icon">
  </head>
  <body class="article">
<script type="module" src="https://unpkg.com/@jenkinsci/jenkins-io-components?module"></script>
<jio-navbar style="  position: fixed;
  top: 0;
  width: 100vw;
  z-index: 100;"></jio-navbar>
  <div class="body">
<div class="nav-container" data-component="user-docs" data-version="2.401.3">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Jenkins User Documentation</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../installing-jenkins/index.html">Installing Jenkins</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installing-jenkins/docker.html">Using Docker with Pipeline</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installing-jenkins/initial-settings.html">Initial Settings</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installing-jenkins/kubernetes.html">Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installing-jenkins/linux.html">Linux</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installing-jenkins/macos.html">macOS</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installing-jenkins/offline.html">Offline Installations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installing-jenkins/other.html">Other Systems</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installing-jenkins/servlet-containers.html">Other Servlet Containers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../installing-jenkins/war-file.html">WAR file</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../platform-information/support-policy-windows.html">Windows</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../platform-information/index.html">Platform Information</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../platform-information/upgrade-java-to-11.html">Upgrading to Java 11</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../platform-information/support-policy-windows.html">Windows Support Policy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../platform-information/support-policy-linux.html">Linux Support Policy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../platform-information/support-policy-web-browsers.html">Browser compatibility</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../platform-information/support-policy-java.html">Java Support Policy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../platform-information/support-policy-servlet-containers.html">Servlet Container Support Policy</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../platform-information/upgrade-java-to-17.html">Upgrading to Java 17</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../using-jenkins/index.html">Using Jenkins</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/using-credentials.html">Using credentials</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/searchbox.html">Using Search Box</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/referencing-another-project-by-name.html">Referencing another project by name</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/aborting-a-build.html">Aborting a build</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/fingerprints.html">Fingerprints</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/using-local-language.html">Using local language</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/change-time-zone.html">Change time zone</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/remote-access-api.html">Remote Access API</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/executor-starvation.html">Executor Starvation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/using-agents.html">Using Jenkins agents</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../using-jenkins/using-jmeter-with-jenkins.html">Using JMeter with Jenkins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../pipeline/index.html">Pipeline</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/getting-started.html">Getting started with the Guided Tour</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/jenkinsfile.html">Using a Jenkinsfile</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/running-pipelines.html">Running a Pipeline</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/multibranch.html">Branches and Pull Requests</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/docker.html">Using Docker with pipeline</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/shared-libraries.html">Extending with Shared Libraries</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/development.html">Pipeline Development Tools</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/syntax.html">Pipeline syntax</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/pipeline-best-practices.html">Pipeline Best Practices</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/scaling-pipeline.html">Scaling Pipelines</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../pipeline/cps-method-mismatches.html">Pipeline CPS Method Mismatches</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../blueocean/index.html">Blue Ocean</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../blueocean/getting-started.html">Getting started with the Guided Tour</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../blueocean/creating-pipelines.html">Creating a Pipeline</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../blueocean/dashboard.html">Dashboard</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../blueocean/activity.html">Activity View</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../blueocean/pipeline-run-details.html">Pipeline Run Details View</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../blueocean/pipeline-editor.html">Pipeline Editor</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../managing/index.html">Managing Jenkins</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/system-configuration.html">Configuring the System</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/casc.html">Configuration as Code</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/tools.html">Managing Tools</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/plugins.html">Managing Plugins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/about-jenkins.html">About Jenkins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/system-info.html">System Information</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/system-properties.html">Jenkins Features Controlled with System Properties</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/change-system-timezone.html">Change System Time Zone</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/cli.html">Jenkins CLI</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/script-console.html">Script Console</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/groovy-hook-scripts.html">Groovy Hook Scripts</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/nodes.html">Managing Nodes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/script-approval.html">In-process Script Approval</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/users.html">Users</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/ui-themes.html">Themes for user interface</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/user-content.html">User Content</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../managing/spawning-processes.html">Spawning Processes From Build</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../security/index.html">Securing Jenkins</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/access-control.html">Access Control</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/securing-jenkins.html">Securing Jenkins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/managing-security.html">Managing Security</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/controller-isolation.html">Controller Isolation</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/securing-builds.html">Securing Builds</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/csrf-protection.html">CSRF Protection</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/user-content.html">Rendering User Content</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/build-authorization.html">Access Control for Builds</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/environment-variables.html">Handling Environment Variables</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/markup-formatter.html">Markup Formatters</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../security/services.html">Exposed Services and Ports</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="index.html">System Administration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="backing-up.html">Backing-up/Restoring Jenkins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="monitoring.html">Monitoring Jenkins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="administering-jenkins-on-kubernetes.html">Administering Jenkins on Kubernetes</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="with-chef.html">Managing Jenkins with Chef</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="with-puppet.html">Managing Jenkins with Puppet</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="viewing-logs.html">Viewing logs</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="authenticating-scripted-clients.html">Authenticating scripted clients</a>
  </li>
  <li class="nav-item" data-depth="1">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="reverse-proxy-configuration-with-jenkins/index.html">Reverse proxy configuration</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="reverse-proxy-configuration-with-jenkins/reverse-proxy-configuration-apache.html">Reverse proxy - Apache</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="reverse-proxy-configuration-with-jenkins/reverse-proxy-configuration-nginx.html">Reverse proxy - Nginx</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="reverse-proxy-configuration-with-jenkins/reverse-proxy-configuration-haproxy.html">Reverse proxy - HAProxy</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="reverse-proxy-configuration-with-jenkins/reverse-proxy-configuration-squid.html">Reverse proxy - Squid</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="reverse-proxy-configuration-with-jenkins/reverse-proxy-configuration-iis.html">Reverse proxy - IIS</a>
  </li>
  <li class="nav-item" data-depth="2">
    <a class="nav-link" href="reverse-proxy-configuration-with-jenkins/reverse-proxy-configuration-iptables.html">Reverse proxy - iptables</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="#reverse-proxy-configuration-with-jenkins/reverse-proxy-configuration-troubleshooting.adoc">reverse-proxy-configuration-with-jenkins/reverse-proxy-configuration-troubleshooting.adoc</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="systemd-services.html">Managing systemd services</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../scaling/index.html">Scaling Jenkins</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../scaling/architecting-for-scale.html">Architecting for Scale</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../scaling/hardware-recommendations.html">Hardware Recommendations</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../scaling/architecting-for-manageability.html">Architecting for Manageability</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../scaling/scaling-jenkins-on-kubernetes.html">Scaling Jenkins on Kubernetes</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <a class="nav-link" href="../troubleshooting/index.html">Troubleshooting Jenkins</a>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting/diagnosing-errors.html">Diagnosing Errors</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../troubleshooting/obtaining-a-thread-dump.html">Obtaining a thread dump</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../glossary/index.html">Glossary</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Jenkins User Documentation</span>
    <span class="version">2.401.3</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../../about/index.html">About Jenkins</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../about/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../images/index.html">All of Jenkins Images</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../images/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../books/index.html">Jenkins Books</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../books/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../community/index.html">Jenkins Community</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../community/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../dev-docs/index.html">Jenkins Developer Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../dev-docs/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../download/latest/index.html">Jenkins Download and Deployment</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../download/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../events/index.html">Jenkins Events</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../events/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../Jenkins%20Project/index.html">Jenkins Project</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../Jenkins%20Project/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../projects/index.html">Jenkins Projects</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../projects/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../security/index.html">Jenkins Security Advisories</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../security/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../solutions/2.401.3/index.html">Jenkins Solutions Page</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../solutions/2.401.3/index.html">2.401.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../sigs/index.html">Jenkins Special Interest Groups</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../sigs/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../../tutorial/2.401.3/index.html">Jenkins Tutorials</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../../tutorial/2.401.3/index.html">2.401.3</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Jenkins User Documentation</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">2.401.3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
  <ul>
    <li><a href="../index.html">Jenkins User Documentation</a></li>
    <li><a href="reverse-proxy-configuration-iis.html">Reverse proxy - IIS</a></li>
  </ul>
</nav>
  <div class="edit-this-page"><a href="https://github.com/Vandit1604/jenkins-docs/edit/main/docs/user-docs/modules/system-administration/pages/reverse-proxy-configuration-iis.adoc"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>  Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<h1 class="page">Reverse proxy - IIS</h1>
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>In situations where you have existing web sites on your server, you may
find it useful to run Jenkins (or the servlet container that Jenkins
runs in) behind IIS, so that you can bind Jenkins
to the part of a bigger website that you may have.
This section discusses some of the approaches for doing this.</p>
</div>
<div class="paragraph">
<p><strong>Make sure that you change the Jenkins httpListenAddress from its
default of 0.0.0.0 to 127.0.0.1 or configure the firewall to block
request on the port Jenkins is bound to, otherwise any IIS-level
restrictions can be easily bypassed by accessing the Jenkins port
directly.</strong></p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_requirements"><a class="anchor" href="#_requirements"></a>Requirements</h2>
<div class="sectionbody">
<div class="ulist">
<ul>
<li>
<p>IIS 7.0 or greater.</p>
<div class="ulist">
<ul>
<li>
<p>IIS 8.5 or greater if you want
<a href="https://docs.microsoft.com/en-us/iis/get-started/whats-new-in-iis-85/certificate-rebind-in-iis85">Certificate
Rebind</a>.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://www.iis.net/downloads/microsoft/url-rewrite">URL Rewrite 2.1</a>
or greater.</p>
<div class="ulist">
<ul>
<li>
<p>As the <a href="https://blogs.iis.net/iisteam/url-rewrite-v2-1">announcement</a>
explains, it introduces a feature flag to turn off the default
non-compliant-RFC3986 behavior. Which is what we want.</p>
</li>
</ul>
</div>
</li>
<li>
<p><a href="https://www.iis.net/downloads/microsoft/application-request-routing">Application
Request Routing</a>  3.0 or greater.</p>
</li>
<li>
<p>Server access</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_example_use_case"><a class="anchor" href="#_example_use_case"></a>Example use case</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I have a dedicated Jenkins installation on a Windows Server 2012 R2
server with a Common Name of <strong>VRTJENKINS01</strong> in the Active Directory
domain <strong>acme.example</strong> and is reachable by the Fully Qualified Domain
Name <strong>vrtjenkins01.acme.example</strong>.
Additionally Jenkins runs on port <strong>8080</strong> and already listens to <strong>127.0.0.1</strong>
instead of 0.0.0.0 and the server has additional DNS names: <strong>jenkins</strong> and
<strong>jenkins.acme.example</strong>.</p>
</div>
<div class="paragraph">
<p>I want to have an IIS installation which acts as a TLS/SSL terminating
reverse proxy.
In combination with our in-house Active Directory Certificate Services
(ADCS, Microsoft&#8217;s Certificate Authority software) this should make
certificate management a lot easier since Windows can be configured to
automatically renew certificates, and the IIS 8.5+ Certificate Rebind
feature can listen to renewal events (which contain the fingerprints of
both the old and new certificate) and update the relevant bind(s) to use
the fresh certificate.
This would ensure that after the initial manual request it would only be
necessary to manually change TLS/SSL related settings when the set of
Alternate Subject Names on the certificate IIS presents should change.</p>
</div>
<div class="paragraph">
<p>IIS will only have to act as 1) a reverse proxy for Jenkins 2) redirect
non-canonical URLs to the canonical URL: <em>https://jenkins.acme.example/</em></p>
</div>
<div class="paragraph">
<p>I have installed the IIS (8.5) role using the <em>Add Roles and Features
Wizard</em> with the all the default and also the following non-default
features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>HTTP Redirection (Under <em>Common HTTP Features</em>, to
redirect \http(s)://jenkins/, etc. to
<a href="https://jenkins.acme.example/" class="bare">https://jenkins.acme.example/</a>)</p>
</li>
<li>
<p>WebSocket Protocol (Under <em>Application Development</em>, because I felt
like it)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Then I installed URL Rewrite and Application Request Routing.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_configuration_time"><a class="anchor" href="#_configuration_time"></a>Configuration Time</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_enabling_reverse_proxy_functionality"><a class="anchor" href="#_enabling_reverse_proxy_functionality"></a>Enabling Reverse Proxy functionality</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In the <em>Internet Information Services (IIS) Manager</em> click on the
VRTJENKINS01 server.</p>
</li>
<li>
<p>Go to <em>Application Request Routing Cache</em>.</p>
</li>
<li>
<p>In the <em>Actions</em> panel click on <em>Server Proxy Settings&#8230;&#8203;</em></p>
</li>
<li>
<p>Enable the proxy</p>
</li>
<li>
<p>Disable the <em>Reverse rewrite host in response header</em></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Don&#8217;t worry, it will work, just follow the rest of the instructions</p>
</li>
</ol>
</div>
</li>
<li>
<p>Set the <em>Response buffer threshold (KB)</em> to 0.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>This helps to prevent HTTP 502 errors on Jenkins' Replay pages.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Apply (the <em>Actions</em> panel again)</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_tlsssl"><a class="anchor" href="#_configuring_tlsssl"></a>Configuring TLS/SSL</h3>
<div class="paragraph">
<p>Out of scope, there are enough tutorials on the rest of the interwebs
for this part.
The rest of this tutorial will assume it has been configured with a
certificate trusted by your browser of choice.</p>
</div>
</div>
<div class="sect2">
<h3 id="_configuring_rules_for_response_rewriting"><a class="anchor" href="#_configuring_rules_for_response_rewriting"></a>Configuring rules for response rewriting</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Go to the <em>Default Web Site</em></p>
</li>
<li>
<p>Go to <em>URL Rewrite</em></p>
</li>
<li>
<p>In the <em>Actions</em> panel click <em>View Server Variables&#8230;&#8203;</em></p>
</li>
<li>
<p>Add the following is not already define on the server level:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Name: <strong>HTTP_FORWARDED</strong></p>
</li>
</ol>
</div>
</li>
<li>
<p>Click on <em>Back to Rules</em></p>
</li>
<li>
<p><em>Click on Add Rule(s)&#8230;&#8203;</em></p>
</li>
<li>
<p>Select <em>Reverse Proxy</em> and click on OK</p>
</li>
<li>
<p>Enter <em>jenkins.acme.example</em> and click on OK</p>
</li>
<li>
<p>Open the rule you just created</p>
</li>
<li>
<p>Under <em>Conditions</em> add:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Condition input: <strong>{CACHE_URL}</strong></p>
</li>
<li>
<p>Pattern: <strong>^(http|ws)s://</strong></p>
</li>
</ol>
</div>
</li>
<li>
<p>Under <em>Server Variables</em> add:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Name: <strong>HTTP_FORWARDED</strong>, Value:
<strong>for={REMOTE_ADDR};by={LOCAL_ADDR};host="{HTTP_HOST}";proto="https"</strong>,
Replace: yes</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Jenkins runs under Jetty, Jetty supports
<a href="https://tools.ietf.org/html/rfc7239">RFC7239</a>, so all should be well.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
<li>
<p>Under Action change:</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Rewrite URL to
<strong>\{C:1}\://jenkins.acme.example:8080{UNENCODED_URL}</strong></p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>Note that there is no slash between the port number and the opening
curly bracket</p>
</li>
</ol>
</div>
</li>
<li>
<p><strong>Remove</strong> the check from the <strong>Append query string</strong> checkbox</p>
</li>
</ol>
</div>
</li>
<li>
<p>Apply the changes.</p>
</li>
<li>
<p>Edit <em>C:\Windows\System32\drivers\etc\hosts</em> so that
<strong>jenkins.acme.example</strong> points to 127.0.0.1</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>When resolving names Windows will check if the name is its own name
before consulting the hosts file. Meaning that adding <em>vrtjenkins01</em> or
<em>vrtjenkins01.acme.example</em> to the hosts file won&#8217;t have any effect.</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>The hosts file will however be consulted before consulting the DNS
infrastructure</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_experiencing_the_dreaded_it_appears_that_your_reverse_proxy_set_up_is_broken_error_for_yourself"><a class="anchor" href="#_experiencing_the_dreaded_it_appears_that_your_reverse_proxy_set_up_is_broken_error_for_yourself"></a>Experiencing the dreaded "It appears that your reverse proxy set up is broken." error for yourself</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>https://jenkins.acme.example/configure</p>
</li>
<li>
<p>Configure the <em>Jenkins URL</em> to
be <strong>https://jenkins.acme.example/</strong>
and save the change</p>
</li>
<li>
<p>Go to <em>Security</em> and enable
<em>Enable proxy compatibility</em> if you have already enabled <em>Prevent Cross
Site Request Forgery exploits</em></p>
</li>
<li>
<p>Go to https://jenkins.acme.example/manage</p>
</li>
<li>
<p>You will still experience the "It appears that your reverse
proxy set up is broken." as expected</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>If you do not get that at this point, then that is very weird&#8230;&#8203;
Continue anyway.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Right click the <em>System</em> link and choose to
inspect the element.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Make sure you are still on the Manage page as you will want
it as your referrer</p>
</li>
</ol>
</div>
</li>
<li>
<p>Change the value of the <em>href</em> attribute to be
<em>administrativeMonitor/hudson.diagnosis.ReverseProxySetupMonitor/test</em></p>
</li>
<li>
<p>Open the link you just changed in a new tab.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Keep this tab open</p>
</li>
</ol>
</div>
</li>
<li>
<p>Observe the "https://jenkins.acme.example/manage
vs http:" error and bask in its glory</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>a white page served with HTTP status code is 200 indicates
all is well</p>
<div class="olist lowerroman">
<ol class="lowerroman" type="i">
<li>
<p>If you do get that at this point, then that is very
weird&#8230;&#8203; Continue anyway.</p>
</li>
</ol>
</div>
</li>
</ol>
</div>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_fixing_the_errors"><a class="anchor" href="#_fixing_the_errors"></a>Fixing the errors</h3>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>In IIS Manager got to <em>Application Pools</em> then edit
<em>DefaultAppPool</em> so that the <em>.NET CLR version</em> is <strong>No Managed Code</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>You might find that this is not necessary (at far as you
can tell) for your setup, since IIS will only act as a TLS/SSL
offloading reverse proxy, we don&#8217;t need it.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Then go to <em>Sites</em> → <em>Default Web Site</em> → <em>Request
Filtering</em> and in the <em>Actions</em> panel choose <em>Edit Feature Settings&#8230;&#8203;</em>
and turn on <strong>Allow double escaping</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>This is so IIS forwards URLs like
https://jenkins.acme.example/%2525 to Jenkins instead of
showing an IIS error page</p>
</li>
</ol>
</div>
</li>
<li>
<p>Last, but not least, go to <em>Sites</em> → <em>Default Web
Site</em> → <em>Configuration Editor</em> and change the <em>Section</em> to
<em>system.webServer/rewrite/rules</em></p>
</li>
<li>
<p>Now you should see the URL Rewrite 2.1 property
<em>useOriginalURLEncoding</em> listed, if not install URL Rewrite 2.1 using
the x86 or x64 installer, not the WebPI one and resume from here after a
reboot.</p>
</li>
<li>
<p>Change <em>useOriginalURLEncoding</em> to <strong>False</strong></p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>As the URL Rewrite 2.1 announcement this will change the
value of {UNENCODED_URL} to make it <em>RFC3986</em> and usable for reverse
proxy forwarding purposes</p>
</li>
<li>
<p>original as in pre 2.1 behaviour.</p>
</li>
</ol>
</div>
</li>
<li>
<p>Refresh that tab you were supposed to keep open, or recreate
it.</p>
<div class="olist loweralpha">
<ol class="loweralpha" type="a">
<li>
<p>Again, take some time to bask in its glory</p>
</li>
</ol>
</div>
</li>
<li>
<p>It should now be white, also the Manage page should no
longer complain!</p>
</li>
</ol>
</div>
</div>
<div class="sect2">
<h3 id="_continue_configuring_iis"><a class="anchor" href="#_continue_configuring_iis"></a>Continue configuring IIS</h3>
<div class="paragraph">
<p>Some of the things you might want but I won&#8217;t cover:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><em>Hypertext Strict Transport Security</em> headers</p>
</li>
<li>
<p>Redirecting from non canonical URLs to the canonical URL
(ok, sort of covered this in the web.config example)</p>
</li>
<li>
<p>The X-UA-Compatibility header so that Internet Explorer 11
(or 9, or &#8230;&#8203;) won&#8217;t claim to be IE 7 for intranet sites</p>
</li>
<li>
<p>Use IIS Crypto to configure cipher suites</p>
</li>
<li>
<p>&#8230;&#8203;</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_a_working_web_config"><a class="anchor" href="#_a_working_web_config"></a>A working web.config</h3>
<div class="paragraph">
<p><strong>web.config</strong></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlightjs highlight"><code class="language-xml hljs" data-lang="xml">&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;configuration&gt;
  &lt;system.webServer&gt;
    &lt;rewrite&gt;
      &lt;rules useOriginalURLEncoding="false"&gt;
        &lt;rule name="CanonicalHostNameRule2" stopProcessing="true"&gt;
          &lt;match url="(.*)" /&gt;
          &lt;conditions trackAllCaptures="true"&gt;
            &lt;add input="{CACHE_URL}" pattern="^(http|ws)://" /&gt;
            &lt;add input="{HTTP_HOST}"
                 pattern="^jenkins$|^jenkins\.acme\.example$|
                          ^vrtjenkins01$|^vrtjenkins01\.acme\.example$" /&gt;
          &lt;/conditions&gt;
          &lt;action type="Redirect"
                  url="{C:1}s://jenkins.acme.example{UNENCODED_URL}"
                  appendQueryString="false"
                  redirectType="Permanent" /&gt;
        &lt;/rule&gt;
        &lt;rule name="CanonicalHostNameRule1" stopProcessing="true"&gt;
          &lt;match url="(.*)" /&gt;
          &lt;conditions trackAllCaptures="true"&gt;
            &lt;add input="{CACHE_URL}" pattern="^(https|wss)://" /&gt;
            &lt;add input="{HTTP_HOST}" pattern="^jenkins$|^vrtjenkins01$|
                                              ^vrtjenkins01\.acme\.example$" /&gt;
          &lt;/conditions&gt;
          &lt;action type="Redirect"
                  url="{C:1}://jenkins.acme.example{UNENCODED_URL}"
                  appendQueryString="false" redirectType="Permanent" /&gt;
        &lt;/rule&gt;
        &lt;rule name="ReverseProxyInboundRule1" stopProcessing="true"&gt;
          &lt;match url="(.*)" /&gt;
          &lt;action type="Rewrite"
                  url="{C:1}://jenkins.acme.example:8080{UNENCODED_URL}"
                  appendQueryString="false" /&gt;
          &lt;serverVariables&gt;
            &lt;set name="HTTP_FORWARDED"
                 value="for={REMOTE_ADDR};
                        by={LOCAL_ADDR};
                        host=&amp;quot;{HTTP_HOST}&amp;quot;;
                        proto=&amp;quot;https&amp;quot;" /&gt;
          &lt;/serverVariables&gt;
          &lt;conditions trackAllCaptures="true"&gt;
            &lt;add input="{CACHE_URL}" pattern="^(http|ws)s://" /&gt;
            &lt;add input="{HTTP_HOST}" pattern="^jenkins\.acme\.example$" /&gt;
          &lt;/conditions&gt;
        &lt;/rule&gt;
      &lt;/rules&gt;
    &lt;/rewrite&gt;
    &lt;security&gt;
      &lt;requestFiltering allowDoubleEscaping="true" /&gt;
    &lt;/security&gt;
  &lt;/system.webServer&gt;
&lt;/configuration&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</article>
  </div>
</main>
</div>
<jio-footer></jio-footer>
<script id="site-script" src="../../../_/js/site.js" data-ui-root-path="../../../_"></script>
<script async src="../../../_/js/vendor/highlight.js"></script>
  </body>
</html>
