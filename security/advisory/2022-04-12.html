<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Jenkins</title>
    <link rel="canonical" href="https://docs.jenkins.com/security/advisory/2022-04-12.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
<link rel="icon" href="../../_/226px-Jenkins_logo.svg.png" type="image/x-icon">
  </head>
  <body class="article">
<script type="module" src="https://unpkg.com/@jenkinsci/jenkins-io-components?module"></script>
<jio-navbar style="  position: fixed;
  top: 0;
  width: 100vw;
  z-index: 100;"></jio-navbar>
  <div class="body">
<div class="nav-container" data-component="security" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Jenkins Security Advisories</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">For Adminstrators</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../for-administrators.html">Overview for Jenkins Administrators</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../scheduling.html">How We Schedule Security Advisories</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugins.html">Handling Vulnerabilities in Plugins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fixing.html">How We Fix Security Issues</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">For Reporters</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../reporting.html">Reporting Security Vulnerabilities</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../cna.html">Jenkins CVE Numbers Authority</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">For Maintainers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../for-maintainers.html">Overview for Plugin Maintainers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugins.html">Handling Vulnerabilities in Plugins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jenkins Security Team</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../team.html">About the Jenkins Security Team</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../improvements.html">Improvements by the Security Team</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Jenkins Security Advisories</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../about/index.html">About Jenkins</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../about/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../images/index.html">All of Jenkins Images</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../images/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../books/index.html">Jenkins Books</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../books/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../community/index.html">Jenkins Community</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../community/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../dev-docs/index.html">Jenkins Developer Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../dev-docs/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../download/latest/index.html">Jenkins Download and Deployment</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../download/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../events/index.html">Jenkins Events</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../events/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../Jenkins%20Project/index.html">Jenkins Project</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../Jenkins%20Project/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../projects/index.html">Jenkins Projects</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../projects/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Jenkins Security Advisories</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../solutions/2.401.3/index.html">Jenkins Solutions Page</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../solutions/2.401.3/index.html">2.401.3</a>
        </li>
        <li class="version">
          <a href="../../solutions/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="../../solutions/2.1/index.html">2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../sigs/index.html">Jenkins Special Interest Groups</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../sigs/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../tutorial/2.401.3/index.html">Jenkins Tutorials</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../tutorial/2.401.3/index.html">2.401.3</a>
        </li>
        <li class="version">
          <a href="../../tutorial/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="../../tutorial/2.1/index.html">2.1</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../user-docs/2.401.3/index.html">Jenkins User Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../user-docs/2.401.3/index.html">2.401.3</a>
        </li>
        <li class="version">
          <a href="../../user-docs/2.2/index.html">2.2</a>
        </li>
        <li class="version">
          <a href="../../user-docs/2.1/index.html">2.1</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../user-docs/2.401.3/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/Vandit1604/jenkins-docs/edit/main/docs/security/modules/ROOT/pages/advisory/2022-04-12.adoc"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>  Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<hr>
<div class="paragraph">
<p>layout: advisory
title: Jenkins Security Advisory 2022-04-12
kind: plugins
issues:
- id: SECURITY-2617
  reporter: Kevin Guerroudj, CloudBees, Inc., Wadeck Follonier, CloudBees, Inc., and
    Daniel Beck, CloudBees, Inc.
  title: Stored XSS vulnerabilities in multiple plugins providing additional parameter
    types
  cve: CVE-2022-29036 (Credentials), CVE-2022-29037 (CVS), CVE-2022-29038 (Extended
    Choice Parameter), CVE-2022-29039 (Gerrit Trigger), CVE-2022-29040 (Git Parameter),
    CVE-2022-29041 (Jira), CVE-2022-29042 (Job Generator), CVE-2022-29043 (Mask Passwords),
    CVE-2022-29044 (Node and Label Parameter), CVE-2022-29045 (promoted builds), CVE-2022-29046
    (Subversion)
  cvss:
    severity: High
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
  description: |-
    Multiple plugins do not escape the name and description of the parameter types they provide:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Credentials Plugin 1111.v35a_307992395 and earlier (SECURITY-2690 / CVE-2022-29036)</p>
</li>
<li>
<p>CVS Plugin 2.19 and earlier (SECURITY-2700 / CVE-2022-29037)</p>
</li>
<li>
<p>Extended Choice Parameter Plugin 346.vd87693c5a_86c and earlier (SECURITY-2704 / CVE-2022-29038)</p>
</li>
<li>
<p>Gerrit Trigger Plugin 2.35.2 and earlier (SECURITY-2703 / CVE-2022-29039)</p>
</li>
<li>
<p>Git Parameter Plugin 0.9.15 and earlier (SECURITY-2699 / CVE-2022-29040)</p>
</li>
<li>
<p>Jira Plugin 3.7 and earlier (SECURITY-2691 / CVE-2022-29041)</p>
</li>
<li>
<p>Job Generator 1.22 and earlier (SECURITY-2263 / CVE-2022-29042)</p>
</li>
<li>
<p>Mask Passwords Plugin 3.0 and earlier (SECURITY-2701 / CVE-2022-29043)</p>
</li>
<li>
<p>Node and Label parameter Plugin 1.10.3 and earlier (SECURITY-2702 / CVE-2022-29044)</p>
</li>
<li>
<p>promoted builds Plugin 873.v6149db_d64130 and earlier (SECURITY-2692 / CVE-2022-29045)</p>
</li>
<li>
<p>Subversion Plugin 2.15.3 and earlier (SECURITY-2698 / CVE-2022-29046)</p>
<div class="literalblock">
<div class="content">
<pre>This results in stored cross-site scripting (XSS) vulnerabilities exploitable by attackers with Item/Configure permission.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Exploitation of these vulnerabilities requires that parameters are listed on another page, like the "Build With Parameters" and "Parameters" pages provided by Jenkins (core), and that those pages are not hardened to prevent exploitation.
Jenkins (core) has prevented exploitation of vulnerabilities of this kind on the "Build With Parameters" and "Parameters" pages since 2.44 and LTS 2.32.2 as part of the link:/security/advisory/2017-02-01/#persisted-cross-site-scripting-vulnerability-in-parameter-names-and-descriptions[SECURITY-353 / CVE-2017-2601] fix.
Additionally, the following plugins have been updated to list parameters in a way that prevents exploitation by default.</pre>
</div>
</div>
</li>
<li>
<p>plugin:m2release[Maven Release Plugin] 0.16.3 (SECURITY-2669)</p>
</li>
<li>
<p>plugin:pipeline-build-step[Pipeline: Build Step Plugin] 2.17 and 2.15.2 (SECURITY-2611)</p>
</li>
<li>
<p>plugin:pipeline-input-step[Pipeline: Input Step Plugin] 447.v95e5a_6e3502a_ and 2.12.1 (SECURITY-2674)</p>
</li>
<li>
<p>plugin:promoted-builds[promoted builds Plugin] 876.v99d29788b_36b_ and 3.10.1 (SECURITY-2670)</p>
</li>
<li>
<p>plugin:rebuild[Rebuilder Plugin] 1.33.1 (SECURITY-2671)</p>
</li>
<li>
<p>plugin:release[Release Plugin] 2.14 (SECURITY-2672)</p>
<div class="literalblock">
<div class="content">
<pre>Older releases of these plugins allow exploitation of the vulnerabilities listed above.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>As of publication of this advisory, the following plugins have not yet been updated to list parameters in a way that prevents exploitation of these vulnerabilities:</pre>
</div>
</div>
</li>
<li>
<p>plugin:coordinator[Coordinator Plugin] (SECURITY-2668)</p>
</li>
<li>
<p>plugin:show-build-parameters[Show Build Parameters Plugin] (SECURITY-2325)</p>
</li>
<li>
<p>plugin:unleash[Unleash Maven Plugin] (SECURITY-2673)</p>
<div class="literalblock">
<div class="content">
<pre>These are not vulnerabilities in these plugins.
Only plugins defining parameter types can be considered to be vulnerable to this issue.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>NOTE: Some plugins both define parameter types and implement a page listing parameters, so they can appear in multiple lists and may have both a security fix and a security hardening applied.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>The following plugins have been updated to escape the name and description of the parameter types they provide in the versions specified:</pre>
</div>
</div>
</li>
<li>
<p>Credentials Plugin 1112.vc87b_7a_3597f6, 1087.1089.v2f1b_9a_b_040e4, 1074.1076.v39c30cecb_0e2, and 2.6.1.1</p>
</li>
<li>
<p>CVS Plugin 2.19.1</p>
</li>
<li>
<p>Gerrit Trigger Plugin 2.35.3</p>
</li>
<li>
<p>Git Parameter Plugin 0.9.16</p>
</li>
<li>
<p>Jira Plugin 3.7.1 and 3.6.1</p>
</li>
<li>
<p>Mask Passwords Plugin 3.1</p>
</li>
<li>
<p>Node and Label parameter Plugin 1.10.3.1</p>
</li>
<li>
<p>promoted builds Plugin 876.v99d29788b_36b_ and 3.10.1</p>
</li>
<li>
<p>Subversion Plugin 2.15.4</p>
<div class="literalblock">
<div class="content">
<pre>As of publication of this advisory, there is no fix available for the following plugins:</pre>
</div>
</div>
</li>
<li>
<p>Extended Choice Parameter Plugin (SECURITY-2704 / CVE-2022-29038)</p>
</li>
<li>
<p>Job Generator (SECURITY-2263 / CVE-2022-29042)</p>
<div class="literalblock">
<div class="content">
<pre>    link:/security/plugins/#unresolved[Learn why we announce this.]
  plugins:
  - name: credentials
    previous: 1111.v35a_307992395
    fixed: 1112.vc87b_7a_3597f6, 1087.1089.v2f1b_9a_b_040e4, 1074.1076.v39c30cecb_0e2, or 2.6.1.1
  - name: cvs
    previous: '2.19'
    fixed: 2.19.1
  - name: extended-choice-parameter
    previous: 346.vd87693c5a_86c
  - name: gerrit-trigger
    previous: 2.35.2
    fixed: 2.35.3
  - name: git-parameter
    previous: 0.9.15
    fixed: 0.9.16
  - name: jira
    previous: '3.7'
    fixed: 3.7.1 or 3.6.1
  - name: jobgenerator
    previous: '1.22'
  - name: mask-passwords
    previous: '3.0'
    fixed: '3.1'
  - name: nodelabelparameter
    previous: 1.10.3
    fixed: 1.10.3.1
  - name: promoted-builds
    previous: 873.v6149db_d64130
    fixed: 876.v99d29788b_36b_ or 3.10.1
  - name: subversion
    previous: 2.15.3
    fixed: 2.15.4
- id: SECURITY-1951
  reporter: James Nord, CloudBees, Inc. and Jesse Glick, CloudBees, Inc.
  title: Untrusted users can modify some Pipeline libraries in PLUGIN_NAME
  cve: CVE-2022-29047
  cvss:
    severity: High
    vector: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:L/A:L
  description: |-
    Multibranch Pipelines by default limit who can change the Pipeline definition from the Jenkinsfile.
    This is useful for SCMs like GitHub:
    Jenkins can build content from users without commit access, but who can submit pull requests, without granting them the ability to modify the Pipeline definition.
    In that case, Jenkins will just use the Pipeline definition in the pull request's destination branch instead.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>In PLUGIN_NAME 564.ve62a_4eb_b_e039 and earlier the same protection does not apply to uses of the `library` step with a `retriever` argument pointing to a library in the current build's repository and branch (e.g., `library(â€¦, retriever: legacySCM(scm))`).
This allows attackers able to submit pull requests (or equivalent), but not able to commit directly to the configured SCM, to effectively change the Pipeline behavior by changing the library behavior in their pull request, even if the Pipeline is configured to not trust them.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    PLUGIN_NAME 566.vd0a_a_3334a_555 and 2.21.3 aborts library retrieval if the library would be retrieved from the same repository and revision as the current build, and the revision being built is untrusted.
  plugins:
  - name: workflow-cps-global-lib
    previous: 564.ve62a_4eb_b_e039
    fixed: 566.vd0a_a_3334a_555 or 2.21.3
- id: SECURITY-2075
  reporter: James Nord, CloudBees, Inc. and Daniel Beck, CloudBees, Inc.
  title: CSRF vulnerability in PLUGIN_NAME
  cve: CVE-2022-29048
  cvss:
    severity: Medium
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
  description: |-
    PLUGIN_NAME 2.15.3 and earlier does not require POST requests for several form validation methods, resulting in cross-site request forgery (CSRF) vulnerabilities.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>These vulnerabilities allow attackers to connect to an attacker-specified URL.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    PLUGIN_NAME 2.15.4 requires POST requests for the affected form validation methods.
  plugins:
  - name: subversion
    previous: 2.15.3
    fixed: 2.15.4
- id: SECURITY-2655
  reporter: Kevin Guerroudj, CloudBees, Inc. and Wadeck Follonier, CloudBees, Inc.
  title: Promotion names in PLUGIN_NAME are not validated when using Job DSL
  cve: CVE-2022-29049
  cvss:
    severity: High
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:R/S:U/C:H/I:H/A:H
  description: |-
    PLUGIN_NAME provides dedicated support for defining promotions using plugin:job-dsl[Job DSL Plugin].</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>PLUGIN_NAME 873.v6149db_d64130 and earlier does not validate the names of promotions defined in Job DSL.
This allows attackers with Job/Configure permission to create a promotion with an unsafe name.
As a result, the promotion name could be used for cross-site scripting (XSS) or to replace other `config.xml` files.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    PLUGIN_NAME 876.v99d29788b_36b_ and 3.10.1 validates the name of promotions.
  plugins:
  - name: promoted-builds
    previous: 873.v6149db_d64130
    fixed: 876.v99d29788b_36b_ or 3.10.1
- id: SECURITY-2321
  reporter: Kevin Guerroudj, Justin Philip, Marc Heyries
  title: CSRF vulnerability and missing permission checks in PLUGIN_NAME
  cve: CVE-2022-29050 (CSRF), CVE-2022-29051 (missing permission check)
  cvss:
    severity: Medium
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:L/A:N
  description: |-
    PLUGIN_NAME 1.16 and earlier does not perform permission checks in methods implementing form validation.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>This allows attackers with Overall/Read permission to connect to an FTP server using attacker-specified credentials.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Additionally, these form validation methods do not require POST requests, resulting in a cross-site request forgery (CSRF) vulnerability.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>    PLUGIN_NAME 1.17 requires POST requests and appropriate permissions for the affected form validation methods.
  plugins:
  - name: publish-over-ftp
    previous: '1.16'
    fixed: '1.17'
- id: SECURITY-2045
  reporter: Daniel Beck, CloudBees, Inc.
  title: Private key stored in plain text by PLUGIN_NAME
  cve: CVE-2022-29052
  cvss:
    severity: Medium
    vector: CVSS:3.1/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
  description: |-
    PLUGIN_NAME 4.3.8 and earlier stores private keys unencrypted in cloud agent `config.xml` files on the Jenkins controller as part of its configuration.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>These private keys can be viewed by users with Agent/Extended Read permission or access to the Jenkins controller file system.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>  PLUGIN_NAME 4.3.9 stores private keys encrypted.
plugins:
- name: google-compute-engine
  previous: 4.3.8
  fixed: 4.3.9</pre>
</div>
</div>
</li>
</ul>
</div>
</article>
  </div>
</main>
</div>
<jio-footer></jio-footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
