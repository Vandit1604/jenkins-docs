<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Untitled :: Jenkins</title>
    <link rel="canonical" href="https://docs.jenkins.com/security/advisory/2018-12-05.html">
    <meta name="generator" content="Antora 3.1.4">
    <link rel="stylesheet" href="../../_/css/site.css">
    <script>var uiRootPath = '../../_'</script>
<link rel="icon" href="../../_/jenkins.svg" type="image/x-icon">
  </head>
  <body class="article">
<script type="module" src="https://unpkg.com/@jenkinsci/jenkins-io-components?module"></script>
<jio-navbar style="  position: fixed;
  top: 0;
  width: 100vw;
  z-index: 100;"></jio-navbar>
  <div class="body">
<div class="nav-container" data-component="security" data-version="">
  <aside class="nav">
    <div class="panels">
<div class="nav-panel-menu is-active" data-panel="menu">
  <nav class="nav-menu">
    <h3 class="title"><a href="../index.html">Jenkins Security Advisories</a></h3>
<ul class="nav-list">
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">For Adminstrators</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../for-administrators.html">Overview for Jenkins Administrators</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../scheduling.html">How We Schedule Security Advisories</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugins.html">Handling Vulnerabilities in Plugins</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../fixing.html">How We Fix Security Issues</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">For Reporters</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../reporting.html">Reporting Security Vulnerabilities</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../cna.html">Jenkins CVE Numbers Authority</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">For Maintainers</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../for-maintainers.html">Overview for Plugin Maintainers</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../plugins.html">Handling Vulnerabilities in Plugins</a>
  </li>
</ul>
  </li>
  <li class="nav-item" data-depth="0">
    <button class="nav-item-toggle"></button>
    <span class="nav-text">Jenkins Security Team</span>
<ul class="nav-list">
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../team.html">About the Jenkins Security Team</a>
  </li>
  <li class="nav-item" data-depth="1">
    <a class="nav-link" href="../improvements.html">Improvements by the Security Team</a>
  </li>
</ul>
  </li>
</ul>
  </nav>
</div>
<div class="nav-panel-explore" data-panel="explore">
  <div class="context">
    <span class="title">Jenkins Security Advisories</span>
    <span class="version">latest</span>
  </div>
  <ul class="components">
    <li class="component">
      <a class="title" href="../../about/index.html">About Jenkins</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../about/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../images/index.html">All of Jenkins Images</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../images/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../books/index.html">Jenkins Books</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../books/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../community/index.html">Jenkins Community</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../community/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../dev-docs/index.html">Jenkins Developer Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../dev-docs/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../download/latest/index.html">Jenkins Download and Deployment</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../download/latest/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../events/index.html">Jenkins Events</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../events/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../Jenkins%20Project/index.html">Jenkins Project</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../Jenkins%20Project/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../projects/index.html">Jenkins Projects</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../projects/index.html">default</a>
        </li>
      </ul>
    </li>
    <li class="component is-current">
      <a class="title" href="../index.html">Jenkins Security Advisories</a>
      <ul class="versions">
        <li class="version is-current is-latest">
          <a href="../index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../solutions/2.401.3/index.html">Jenkins Solutions Page</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../solutions/2.401.3/index.html">2.401.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../sigs/index.html">Jenkins Special Interest Groups</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../sigs/index.html">latest</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../tutorial/2.401.3/index.html">Jenkins Tutorials</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../tutorial/2.401.3/index.html">2.401.3</a>
        </li>
      </ul>
    </li>
    <li class="component">
      <a class="title" href="../../user-docs/2.401.3/index.html">Jenkins User Documentation</a>
      <ul class="versions">
        <li class="version is-latest">
          <a href="../../user-docs/2.401.3/index.html">2.401.3</a>
        </li>
      </ul>
    </li>
  </ul>
</div>
    </div>
  </aside>
</div>
<main class="article">
<div class="toolbar" role="navigation">
<button class="nav-toggle"></button>
  <a href="../../user-docs/2.401.3/index.html" class="home-link"></a>
<nav class="breadcrumbs" aria-label="breadcrumbs">
</nav>
  <div class="edit-this-page"><a href="https://github.com/Vandit1604/jenkins-docs/edit/main/docs/security/modules/ROOT/pages/advisory/2018-12-05.adoc"><svg xmlns="http://www.w3.org/2000/svg" height="1em" viewBox="0 0 512 512"><!--! Font Awesome Free 6.4.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license (Commercial License) Copyright 2023 Fonticons, Inc. --><path d="M441 58.9L453.1 71c9.4 9.4 9.4 24.6 0 33.9L424 134.1 377.9 88 407 58.9c9.4-9.4 24.6-9.4 33.9 0zM209.8 256.2L344 121.9 390.1 168 255.8 302.2c-2.9 2.9-6.5 5-10.4 6.1l-58.5 16.7 16.7-58.5c1.1-3.9 3.2-7.5 6.1-10.4zM373.1 25L175.8 222.2c-8.7 8.7-15 19.4-18.3 31.1l-28.6 100c-2.4 8.4-.1 17.4 6.1 23.6s15.2 8.5 23.6 6.1l100-28.6c11.8-3.4 22.5-9.7 31.1-18.3L487 138.9c28.1-28.1 28.1-73.7 0-101.8L474.9 25C446.8-3.1 401.2-3.1 373.1 25zM88 64C39.4 64 0 103.4 0 152V424c0 48.6 39.4 88 88 88H360c48.6 0 88-39.4 88-88V312c0-13.3-10.7-24-24-24s-24 10.7-24 24V424c0 22.1-17.9 40-40 40H88c-22.1 0-40-17.9-40-40V152c0-22.1 17.9-40 40-40H200c13.3 0 24-10.7 24-24s-10.7-24-24-24H88z"/></svg>  Edit this Page</a></div>
  </div>
  <div class="content">
<aside class="toc sidebar" data-title="Contents" data-levels="2">
  <div class="toc-menu"></div>
</aside>
<article class="doc">
<hr>
<div class="paragraph">
<p>layout: advisory
title: Jenkins Security Advisory 2018-12-05
section: security
kind: core
core:
  lts:
    previous: 2.138.3
    fixed: either 2.138.4 or 2.150.1
  weekly:
    previous: 2.153
    fixed: 2.154
issues:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>id: SECURITY-595
title: Code execution through crafted URLs
reporter: &gt;
  Daniel Beck, CloudBees, Inc., Jesse Glick, CloudBees, Inc., and Wadeck Follonier, CloudBees, Inc.;
  and, independently,
  Apple Information Security;
  Evan Grant of Tenable; and
  Orange Tsai(@orange_8361) from DEVCORE</p>
<div class="literalblock">
<div class="content">
<pre>cve: CVE-2018-1000861
cvss:
  severity: critical
  vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
description: |
  Jenkins uses the Stapler web framework for HTTP request handling.
  Stapler's basic premise is that it uses reflective access to code elements matching its naming conventions.
  For example, any public method whose name starts with `get`, and that has a `String`, `int`, `long`, or no argument can be invoked this way on objects that are reachable through these means.
  As these naming conventions closely match common code patterns in Java, accessing crafted URLs could invoke methods never intended to be invoked this way.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>As of publication of this advisory, we are aware of the following potential attacks in the latest Jenkins releases that do not yet contain this fix:</pre>
</div>
</div>
<div class="ulist">
<ul>
<li>
<p>Unauthenticated users can invalidate all sessions when running Jenkins with the built-in Winstone-Jetty server.</p>
</li>
<li>
<p>Users with Overall/Read permission could create new user objects in memory.</p>
</li>
<li>
<p>Users with Overall/Read access could manually kick off otherwise periodically executed runs of implementations of <code>AsyncPeriodicWork</code>.</p>
<div class="literalblock">
<div class="content">
<pre>The previous two Jenkins security updates, LTS 2.121.3 and 2.138, as well as Jenkins LTS 2.138.2 and 2.146 included changes that prevent a number of other attacks resulting from this vulnerability.
The following is a selection of attacks that were discovered during fix development, and are already being prevented on current releases of Jenkins:</pre>
</div>
</div>
</li>
<li>
<p>Up to Jenkins 2.121.2 or 2.137, unauthenticated users could bypass Overall/Read and Job/Read permission checks and access information about builds in jobs with currently running builds, such as their build logs.</p>
</li>
<li>
<p>Up to Jenkins 2.121.2 or 2.137, users with Overall/Read access could bypass Job/Read permission checks for all jobs.
It was also possible to enumerate all top-level jobs on a given instance.</p>
</li>
<li>
<p>Up to Jenkins 2.121.2 or 2.137, unauthenticated users could access the environment variables defined for the Jenkins controller itself, or any agent process.</p>
</li>
<li>
<p>Up to Jenkins 2.138.1 or 2.145, users with Overall/Read and Credentials/View permissions could enumerate all credentials stored in the system-wide credentials store, and access the user names and passwords (Credentials Plugin).
Up to Jenkins 2.121.2 or 2.138, only the Credentials/View permission was required.</p>
</li>
<li>
<p>Up to Jenkins 2.138.1 or 2.145, unauthenticated users could access the LDAP password from the configuration of the LDAP security realm (LDAP Plugin).</p>
<div class="literalblock">
<div class="content">
<pre>IMPORTANT: The security-related improvements released in Jenkins LTS 2.121.3 and 2.138, as well as Jenkins LTS 2.138.2 and 2.146 are an important part of this fix, and we strongly recommend not disabling them.
Disabling them enables some of the attacks described above.
Previously published documentation has been updated.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Given the vast potential attack surface, we fully expect other attacks, that we are not currently aware of, to be possible on Jenkins releases that do not have this fix applied.
This is reflected in the high score we assigned to this issue, rather than limiting the score to the impact through known issues.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>The Stapler web framework has been extended with a Service Provider Interface (SPI) that allows methods and fields to be excluded from routing.
The implementation of that SPI in Jenkins now restricts which getter methods, `do*` action methods, and fields can be invoked reflectively by Stapler.
Further details are available in the developer documentation:</pre>
</div>
</div>
</li>
<li>
<p><a href="../../dev-docs/handling-requests/stapler-accessible-type.html" class="xref page">Making Object Accessible via Stapler</a></p>
</li>
<li>
<p><a href="../../dev-docs/handling-requests/actions.html" class="xref page">Web Methods</a></p>
</li>
<li>
<p><a href="../../dev-docs/security/read-access.html" class="xref page">Restricting HTTP Access to AccessControlled Objects</a></p>
<div class="literalblock">
<div class="content">
<pre>NOTE: This change is expected to impact existing functionality in some plugins.
The most likely effect is that some URLs now return `404 Not Found`.
In rare cases, the responses returned might not be `404 Not Found`, but still different than they would have been before this fix was applied.
We track known affected plugins and their status in link:https://wiki.jenkins.io/display/JENKINS/Plugins+affected+by+the+SECURITY-595+fix[the Jenkins wiki].</pre>
</div>
</div>
</li>
</ul>
</div>
</li>
<li>
<p>id: SECURITY-1072
title: Forced migration of user records
reporter: Nimrod Stoler of CyberArk Labs, and, independently, Evan Grant of Tenable
cve: CVE-2018-1000863
cvss:
  severity: medium
  vector: CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:N/I:L/A:L
description: |
  The fix for <a href="../2017-11-08">SECURITY-499</a> introduced a mechanism that renamed user directories on disk as a user with an unsafe user name (user ID) is loaded.
  Insufficient input validation allowed attackers to rename such user directories even for users with a safe user name by submitting a crafted user name when attempting to log in, even with an invalid password.
  Doing so prevented users from logging in successfully afterwards.</p>
<div class="literalblock">
<div class="content">
<pre>Jenkins no longer uses directory names as a reference for user names, making the on-load migration of user records unnecessary.
Instead, the new file `users/users.xml` is used to map user names to the directories containing the user metadata.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>On the first startup after updating Jenkins to a version containing this fix, existing legacy user directories are migrated.
For further advice related to this user record migration, see link:/doc/upgrade-guide/2.138/#SECURITY-1072[the LTS upgrade guide].</pre>
</div>
</div>
</li>
<li>
<p>id: SECURITY-904
title: Workspace browser allowed accessing files outside the workspace
reporter: Apple Information Security
cve: CVE-2018-1000862
cvss:
  severity: medium
  vector: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:L/I:N/A:N
description: |
  The file browser for workspaces, archived artifacts, and <code>$JENKINS_HOME/userContent/</code> followed symbolic links to locations outside the directory being browsed.</p>
<div class="literalblock">
<div class="content">
<pre>While builds typically have access to the file system outside the workspace allocated by Jenkins, this should not extend to beyond the execution of a build on that agent.
Notably, the configuration may have been changed to not allow a build to run on a given agent, but the workspace used during the previous execution still exists, and could allow browsing the file system outside the workspace.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>Neither browsing through the UI nor downloading directory content as a ZIP file allow accessing directories and files outside the workspace anymore.</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>In rare cases, it may be desirable to disable this fix.
To do so, set the Java system property `hudson.model.DirectoryBrowserSupport.allowSymlinkEscape` to `true`.
link:/doc/book/managing/system-properties/[Learn more about system properties in Jenkins].</pre>
</div>
</div>
<div class="literalblock">
<div class="content">
<pre>NOTE: While the same component allows browsing archived artifacts, this fix does not apply to archived artifacts.
Valid symbolic links are archived as the files and directories they point to on the agent, while invalid symlinks cannot escape the root directory for archived artifacts on the Jenkins controller.
This was previously fixed as SECURITY-162 in the link:../2015-02-27/[2015-02-27 security advisory].</pre>
</div>
</div>
</li>
<li>
<p>id: SECURITY-1193
title: Potential denial of service through cron expression form validation
reporter: Denis Shvedchenko, Sphere, Inc.
cve: CVE-2018-1000864
cvss:
  severity: medium
  vector: CVSS:3.0/AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H
description: |
  The form validation for cron expressions (e.g. "Poll SCM", "Build periodically") could enter infinite loops when cron expressions only matching certain rare dates were entered, blocking request handling threads indefinitely.</p>
</li>
</ul>
</div>
</article>
  </div>
</main>
</div>
<jio-footer></jio-footer>
<script id="site-script" src="../../_/js/site.js" data-ui-root-path="../../_"></script>
<script async src="../../_/js/vendor/highlight.js"></script>
  </body>
</html>
